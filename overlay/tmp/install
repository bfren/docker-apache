#!/bin/sh

set -euo pipefail
export BF_E=`basename ${0}`


#======================================================================================================================
# Add www user.
#======================================================================================================================

bf-adduser www


#======================================================================================================================
# Get Apache Version.
#======================================================================================================================

cd /tmp

VERSION=$(cat VERSION)
bf-debug "Apache version ${VERSION}."


#======================================================================================================================
# Install Nginx and dependencies.
#======================================================================================================================

bf-echo "Installing Apache v${VERSION}..."
apk add --no-cache \
    apache2=${VERSION}
bf-done


#======================================================================================================================
# Cleanup.
#======================================================================================================================

bf-debug "Cleaning up default Apache configuration and files."
rm -rf /var/www/*


#======================================================================================================================
# Create and link Apache directories.
#======================================================================================================================

bf-debug "Creating Apache directories."

bf-debug "Linking /www to /var/www/html."
ln -s /www /var/www/html
